<html>
<head>
<title>Frequently Asked Questions of Report Manager</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
</head>

<body>
<h3><b>Frequently Asked Questions</b></h3>
<b>Q. How can I set report parameters at runtime?</b> 
<p>A. <code>CLXReport1.Report.Params.ParamByName('CUSTOMERINI').Value:=2;</code></p>
<p><b>Q. How can I show the parameters before executing?</b></p>
<p>A. <code>if CLXReport1.ShowParams then CLXReport1.Execute</code>;</p>
<p><b>Q. What about passing application opened datasets to the report?</b></p>
<ul>
  <li>Place a TRpAlias component beside the TCLXReport</li>
  <li>Assign AliasList property or CLXReport to RPAlias compoenent.</li>
  <li>In RpAlias, List property add items as alias and TDataset component to assign 
    to the report. Note: In Delphi 5 automatic edition of collections seems to 
    not work so you can do this at runtime.</li>
  <li>At runtime:</li>
</ul>
<p><code>var aitem:TRpAliasListIte</code><code>m;</code></p>
<code><p>begin</p>
<p>aitem:=RPAliasItem.List.Add;</p>
<p>aitem.alias:='AREPORTALIAS';</p>
<p>aitem.dataset:=adataset;</p>
<p>end</p></code>
<p><b>Q. How can I alter the SQL sentence of a report dataset before executing 
  it?</b></p>
<p>A. CLXReport.Report.DataInfo.Items[0].SQL:='SELECT....'</p>
<p><b>Q. How can I pass opened connections or path to databases to the report?</b></p>
<p>A. Depend on the database driver used:</p>
<ul>
  <li>BDE should detect opened aliases</li>
  <li>DBExpress: <code>CLXReport.Report.DabaseInfo.Items[0].SQLConnection:=..</code></li>
  <li>ADO: <code>CLXReport.Report.DabaseInfo.Items[0].ConnectionString</code></li>
  <li>Interbase Express: <code>CLXReport.Report.DabaseInfo.Items[0].IBConnection:=..</code></li>
  <li>Other still not implemented, but you can update dbxconnections.ini, because 
    them read the configuration from this file</li>
</ul>
<p><b>Q. How can I set properties of components at runtime in already loaded report?</b> 
</p>
<p>A.You must find the component you want to modify, Report property in TCLXReport 
  is the owner of all report items:</p>
<p><code>uses rplabelitem;</code></p>
<p><code>...</code></p>
<p><code>var acompo:TRpExpression;</code></p>
<p><code>compo:=CLXReport1.Report.FindComponent('TRpExpression5');</code></p>
<p><code>if Assigned(compo) then</code></p>
<p><code>begin</code></p>
<p> compo.DisplayFormat:='dd/mm/yyyy';</p>
<p><code>end</code></p>
<p><b>Q. I'm designing a report that will be printed in any matrix printer or 
  receipt printer, how can I use printer fonts to speed up the print process?</b></p>
<p>A. At page setup option of Report Manager Designer you can set use allways 
  device fonts option. Allways install the correct driver for the printer or a 
  driver that printer is emulating.</p>
<p><b>Q. Why Report Manager needs TClientDataset?</b></p>
<p> The engine must be capable of go back one record for the main dataset (Prior 
  procedure) because grouping feature, but some datasets only support unidirectional 
  datasets, I use a patched version of TClientDataset (TRpDataset), that no eats 
  lots of memory like TClientDataset, it frees the records it does not need so 
  the engine can print/proces millions of records without memory problems but 
  a bit slower if you print only a few thousand records.</p>
<p><b>Q. Is Report Manager Engine Thread Safe so it can be used in multithreaded 
  applications (servers)?</b></p>
<p>Report Manager is thread safe but there are some issues not only related to 
  Report Manager:<br>
  - BDE is not thread safe by default (a session must be open for each thread), 
  in next version you can assign a session to a database report, in current version 
  you can assign a TDatabase directly to the database report<br>
  component in runtime.<br>
  - Warning about local dabase access modes, some database engines like Interbase/Firebird 
  allow to set a path to the database directly (c:\adatabase.gdb) using local 
  access to database, you must avoid this because it's not thread safe you must 
  use net access mode allways (localhost:c:\adatabase.gdb)<br>
  - Not all VisualCLX components are thread safe so you need to modify this VisualCLX 
  components in the main thread, so the designer package is, becasuse this issue, 
  not thread safe.</p>
<p><b>Q. Can Report Manager print in dot matrix printers in Linux as fast as in 
  Windows?</b></p>
<p>Windows provides drivers and those drivers provide printer specific fonts, 
  so the Windows GDI can merge graphics and texts, the printer driver does the 
  real hard work of printing, Report Manager only search for the best suited font 
  (a printer font) in Windows font list, select it and call Windows specific API 
  to draw the text.</p>
<p>For Linux, Report Manager uses the Kylix graphic engine that uses the Qt graphic 
  engine, the Qt graphics engine writes output usually in postcript and then the 
  printer filter transform it to a understandable language to the printer (usually 
  this work is done by ghostcript).</p>
<p>You must find a print filter or CUPS driver that converts a postcript input 
  from Qt (or any Linux app) to textonly output (or better to graphics and text 
  if exists), may be there is a generic text driver in CUPS or Ghostcript. That 
  is installing a plain text printer driver if it's available.</p>
<p>I don't know the Linux printing procedure in depth so I can be wrong.</p>
<p>Other way to do this is write a driver for Report Manager (now Report<br>
  Manager has three drivers:Qt,PDF,WinGDI), the output of this driver can be<br>
  only text for example, or text with escape codes...</p>
<p><b>Q. Is TeeChart supported?</b></p>
<p>No, for now, because Teechart has no easy way to vectorize the chart so it 
  can not be included in metafiles as vectors (scalable), also it's not included 
  in any version of Kylix.</p>
<p>You can use the chart provided (it's very simple, only supports lines for now). 
  To include support for TeeChart is not difficult but can take some work.</p>
</body>
</html>
